@page "/403"

@using FiyiStackWeb2.Areas.FiyiStackWeb2.VisitorPageCounterBack.Entities;
@using FiyiStackWeb2.Areas.FiyiStackWeb2.VisitorPageCounterBack.Repositories;
@inject VisitorPageCounterRepository visitorPageCounterRepository;

<PageTitle>403 - FiyiStack</PageTitle>

<FiyiStackWeb2.Components.Layout.NavBarHome></FiyiStackWeb2.Components.Layout.NavBarHome>

<div class="page-header align-items-start min-vh-100"
     style="background-image: url(img/System/404Image.png);"
     loading="lazy">
    <span class="mask bg-gradient-dark opacity-6"></span>
    <div class="container my-auto">
        <div class="row">
            <div class="col-lg-12 m-auto text-center">
                <h1 class="display-1 text-bolder text-white">
                    Página no disponible 
                </h1>
                <h3 class="text-white">
                    Lo sentimos pero no tienes acceso a esta página
                </h3>
                <p class="lead text-white">
                    Te recomendamos hablar con el administrador. Mientras tanto te recomendamos 
                    ir a la página de inicio
                </p>
                <NavLink class="btn bg-gradient-warning mt-4"
                href="/">
                    <i class="fas fa-home"></i>
                    Inicio
                </NavLink>
            </div>
        </div>
    </div>
</div>

<FiyiStackWeb2.Components.Layout.FooterHome></FiyiStackWeb2.Components.Layout.FooterHome>

@code {
    [Parameter]
    public string Path { get; set; } = "";

    protected override void OnInitialized()
    {
        try
        {
            //Save visit page
            FiyiStackWeb2.Areas.FiyiStackWeb2.VisitorPageCounterBack.Entities.VisitorPageCounter visitorPageCounter = new()
                {
                    Active = true,
                    DateTimeCreation = DateTime.Now,
                    DateTimeLastModification = DateTime.Now,
                    UserCreationId = 1,
                    UserLastModificationId = 1,
                    PageName = "403"
                };
            visitorPageCounterRepository.Add(visitorPageCounter);

            base.OnInitialized();
        }
        catch (Exception ex)
        {
            Failure failure = new()
                {
                    Active = true,
                    DateTimeCreation = DateTime.Now,
                    DateTimeLastModification = DateTime.Now,
                    UserCreationId = 1,
                    UserLastModificationId = 1,
                    EmergencyLevel = 1,
                    Comment = "",
                    Message = ex.Message,
                    Source = ex.Source,
                    StackTrace = ex.StackTrace
                };

            failureRepository.Add(failure);
        }

    }
}